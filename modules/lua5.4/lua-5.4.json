{
    "name": "lua-5.4",
    "buildsystem": "simple",
    "build-commands": [
        "make -j $FLATPAK_BUILDER_N_JOBS CFLAGS=\"$CFLAGS -fPIC -DLUA_USE_LINUX\" linux",
        "make TO_LIB=liblua.so.5.4.8 INSTALL_TOP=$FLATPAK_DEST install",
        "ln -sf liblua.so.5.4.8 $FLATPAK_DEST/lib/liblua.so",
        "ln -sf liblua.so.5.4.8 $FLATPAK_DEST/lib/liblua.so.5.4",
        "make INSTALL_TOP=${FLATPAK_DEST} pc > lua.pc",
        "cat lua.pc.in >> lua.pc",
        "install -Dm644 lua.pc $FLATPAK_DEST/lib/pkgconfig/lua.pc",
        "ln -sf lua.pc $FLATPAK_DEST/lib/pkgconfig/lua54.pc",
        "ln -sf lua.pc $FLATPAK_DEST/lib/pkgconfig/lua5.4.pc",
        "ln -sf lua.pc $FLATPAK_DEST/lib/pkgconfig/lua-5.4.pc"
    ],
    "sources": [
        {
            "type": "archive",
            "url": "https://www.lua.org/ftp/lua-5.4.8.tar.gz",
            "sha256": "4f18ddae154e793e46eeab727c59ef1c0c0c2b744e7b94219710d76f530629ae"
        },
        {
            "type": "patch",
            "path": "makefile-add-liblua.so-rule.patch"
        },
        {
            "type": "file",
            "path": "lua.pc.in"
        },
        {
            "type": "patch",
            "path": "luaconf.patch"
        }
    ],
    "cleanup": [
        "/bin",
        "/include",
        "/lib/pkgconfig",
        "/man"
    ]
}
